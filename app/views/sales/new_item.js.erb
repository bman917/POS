$('#add_row').bind('click', false);

$('tr#total').before("<%=j render 'sales/item_input_row'%>");

$('#new #close').on('click', function(){ 
	$(this).closest('tr').remove()
	$('#add_row').unbind('click');
});

qty_css = '#qty';


$('#item_name').autocomplete({
  minLength: 2,
  source: "<%=json_items_path%>",
  change: function( event, ui) {
    $('#add_item_button').addClass('hide');
  },
  select: function( event, ui ) {
    //$(item_id_css).val(ui.item.id);
    //$('#item_name').val(ui.item.value);
    $(qty_css).val("");

    //Delay the focus a little bit so the it happens
    //after normal focusing occurs.
    setTimeout(function() {
      $(qty_css).focus(); 
      $('#add_item_button').removeClass('hide');
    }, 100);
    return false;
  }
});

$('#item_name').focus();