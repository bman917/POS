<% content_for :title, "Item List" %>

<%=page_title "Item List" %>

<div id="controls" style="float: left; margin-top: .25em; width: 75%">
  <%=select_tag :po_supplier, 
    options_from_collection_for_select(
      Supplier.all, 'id', 'name', @supplier_id), 
    style: "height: 2.5em;font-size:100%;width: 350px; padding: 0" %>
<%= link_to 'New Item', new_item_path, class: 'pos_action' %>
<%= link_to 'Reset Confirmed Order Count', admin_reset_purchase_orders_path, class: 'pos_action', data: {confirm: 'Are you sure?'} %>

</div>


<%=form_tag destroy_multiple_items_path, method: :delete do %>

<table id="item_selector" class="display" width="100%">
  <thead>
    <tr>
      <th class="dt-center"><%=image_submit_tag 'gtk-delete.png', size: '14x14', data: { confirm: 'Delete Checked Items. Are you sure?' }%></th>
      <th>Name</th>
      <th>Unit</th>
      <th>Supplier</th>
      <th>Confirmed Orders</th>
      <th></th>
      <th></th>

    </tr>
  </thead>

  <tbody>

  </tbody>
</table>
<% end %>

<%=javascript_tag do %>
  $(document).ready( function () {

  columns = <%=raw @items_datatable.columns %>;
  columnDefs = [
    { "orderable": false, "targets": [0,-1,-2]},
    { "className": "dt-center", "targets": [0]}  //center checkbox
  ];

  $('#item_selector').dataTable( {
      "stateSave": true,
      "lengthChange": false,
      "paging": true,
      "pageLength": "100",
      "pagingType": "simple_numbers",
      "jQueryUI": false,
      "processing": true,
      "serverSide": true,
      "searching": true,
      "ajax": {"url": "<%=json_items_path%>", "type": "POST"},
      "columns": columns,
      "columnDefs": columnDefs,
      "order": [[1, 'asc']],
      "dom": 'T<"clear">lfrtip',
      "tableTools" : {
        "aButtons": [
          {
            "sExtends": "pdf",
            "sButtonText": "PDF",
            "mColumns": [ 1, 2, 3 ]
          }]
      },
      "drawCallback": function( settings ) {
          $('#controls').prependTo($('.dataTables_wrapper'));
        }
  } );

} );

<% end %>


<br>

